<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kakao Map 검색</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      margin: 0;
    }
    h1 {
      margin-bottom: 10px;
    }
    .search-box {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }
    #keyword {
      flex: 1;
      padding: 10px 14px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 6px;
      outline: none;
    }
    #keyword:focus {
      border-color: #3182f6;
    }
    button {
      padding: 10px 18px;
      background: #3182f6;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 15px;
    }
    button:hover {
      background: #2563eb;
    }
    #map {
      width: 100%;
      height: 400px;
      border-radius: 10px;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <h1>Kakao Map 검색</h1>

  <div class="search-box">
    <input type="text" id="keyword" placeholder="지역 또는 장소를 입력하세요 (예: 강남역, 이태원 맛집)" />
    <button onclick="searchPlaces()">검색</button>
  </div>

  <div id="map"></div>

  <!-- Kakao Maps SDK (검색 기능을 위해 libraries=services 필수) -->
  <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=12bbe0a7710edf7c1ee095813343dd12&libraries=services"></script>

  <script>
    // 지도 생성
    var mapContainer = document.getElementById('map');
    var mapOption = {
      center: new kakao.maps.LatLng(37.566826, 126.9786567), // 초기 중심: 서울
      level: 3
    };
    var map = new kakao.maps.Map(mapContainer, mapOption);

    // 인포윈도우
    var infowindow = new kakao.maps.InfoWindow({ zIndex: 1 });

    // 장소 검색 객체 생성
    var ps = new kakao.maps.services.Places();

    // 검색 실행 함수
    function searchPlaces() {
      var keyword = document.getElementById('keyword').value.trim();

      if (!keyword) {
        alert('검색어를 입력해주세요.');
        return;
      }

      ps.keywordSearch(keyword, placesSearchCB);
    }

    // 검색 결과 콜백
    function placesSearchCB(data, status, pagination) {
      if (status === kakao.maps.services.Status.OK) {
        // 결과 좌표로 지도 범위 조정
        var bounds = new kakao.maps.LatLngBounds();

        for (var i = 0; i < data.length; i++) {
          displayMarker(data[i]);
          bounds.extend(new kakao.maps.LatLng(data[i].y, data[i].x));
        }

        map.setBounds(bounds);
      } else if (status === kakao.maps.services.Status.ZERO_RESULT) {
        alert('검색 결과가 없습니다.');
      } else if (status === kakao.maps.services.Status.ERROR) {
        alert('검색 중 오류가 발생했습니다. (키/도메인 설정 확인 필요)');
      }
    }

    // 지도에 마커 표시
    function displayMarker(place) {
      var marker = new kakao.maps.Marker({
        map: map,
        position: new kakao.maps.LatLng(place.y, place.x)
      });

      kakao.maps.event.addListener(marker, 'click', function () {
        infowindow.setContent('<div style="padding:5px;font-size:12px;">' + place.place_name + '</div>');
        infowindow.open(map, marker);
      });
    }

    // 엔터 키로 검색 가능
    document.getElementById('keyword').addEventListener('keydown', function(e) {
      if (e.key === 'Enter') {
        searchPlaces();
      }
    });
  </script>
</body>
</html>
